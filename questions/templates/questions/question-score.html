{% extends "base.html" %}

{% block title %}{{ block.super }} - Ergebnis - {{ question.title }}{% endblock %}

{% block content %}
<div id="question-score">

	<h2>{{ question.title }}</h2>

	{% if next_random %}
		<div class="top-right">
			<a class="next-random-btn" href="{% url 'questions_random' %}">
				<div class="label">
					<span>Nächste</span><span>Frage</span>
				</div>
				<i class="fa fa-arrow-circle-right"></i> 
			</a>
		</div>
	{% endif %}

	<section>

		{% if estimate.time_out %}

			<div class="timed_out">
				<p class="icon"><i class="fa fa-exclamation-triangle fa-3x"></i></p>
				<p>Leider ist die Zeit abgelaufen.</p>
			</div>

			<div id="show_btn">Zeige Auflösung</div>

			<div id="show_resolution">
				<span class="title">Auflösung</span>

				{% if question.answer < 99999 %}
					<span class="value">
				{% elif question.answer < 999999999 %}
					<span class="value small">
				{% elif question.answer < 999999999999 %}
					<span class="value smaller">
				{% elif question.answer < 999999999999999 %}
					<span class="value tiny">
				{% else %}
					<span class="value really-tiny">
				{% endif %}

				{{ question.answer|floatformat }}</span> 
				{% if question.unit %}
					<span class="unit">{{ question.unit }}</span>
				{% endif %}
			</div>

			<div class="score">	
				<span class="title">Punkte</span>
				<span class="value">{{ estimate.score }}</span>
			</div>

			<table class="timed_out">
				<tr>
					<td class="left"><strong>&#216; Schätzung</strong></td> 
					<td class="right">{{ avg_estimate.estimate|floatformat:"-2" }}</td>
				</tr>
				<tr>
					<td class="left"><strong>&#216; Punktzahl</strong></td>
					<td class="right">{{ avg_estimate.score|floatformat:"0" }}</td>
				</tr>
			</table>

		{% else %}

			<div class="resolution">	
				<span class="title">Auflösung</span>

				{% if question.answer < 99999 %}
					<span class="value">
				{% elif question.answer < 999999999 %}
					<span class="value small">
				{% elif question.answer < 999999999999 %}
					<span class="value smaller">
				{% elif question.answer < 999999999999999 %}
					<span class="value tiny">
				{% else %}
					<span class="value really-tiny">
				{% endif %}

				{{ question.answer|floatformat }}</span> {% if question.unit %}{{ question.unit }}{% endif %}
			</div>

			<div class="score">	
				<span class="title">Punkte</span>
				<span class="value">{{ estimate.score }}</span>
			</div>
			
			{% if estimate.estimate == question.answer %}
				<h3>Punktlandung!</h3>
			{% elif estimate.score == 100 %}
				<h3>Wahnsinn!</h3>
			{% elif estimate.score >= 98 %}
				<h3>Ganz knapp daneben!</h3>
			{% elif estimate.score >= 95 %}
				<h3>Sehr gut!</h3>
			{% elif estimate.score >= 90 %}
				<h3>Nicht schlecht!</h3>
			{% endif %}

			<table>
				<tr>
					<td class="left"><strong>Schätzung</strong></td>
					<td class="right">{{ estimate.estimate|floatformat:"-2" }}</td>
				</tr>
				<tr>
					<td class="left"><strong>Fehler</strong></td>
					<td class="right">{{ estimate.percentage_error|floatformat:"-2" }} %</td>
				</tr>
				<tr>
					<td class="left"><strong>&#216; Schätzung</strong></td> 
					<td class="right">{{ avg_estimate.estimate|floatformat:"-2" }}</td>
				</tr>
				<tr>
					<td class="left"><strong>&#216; Punktzahl</strong></td>
					<td class="right">{{ avg_estimate.score|floatformat:"0" }}</td>
				</tr>
			</table>

		{% endif %}

		<a class="question-stats-btn" href="{% url 'questions_statistics_question' question.slug %}">
			<i class="fa fa-bar-chart-o"></i>
			Statistik zur Frage
		</a>

	</section>

	<aside>

		<p>{{ question.question }}</p>

		{% if question.unit %}
			<small id="unit">Einheit: {{ question.unit }}</small>
		{% endif %}

		{% if question.image %}
			<p><a href="/{{ question.image }}" data-lightbox="{{ question.slug }}" data-title="{{ question.title }}"><img src="/{{ question.image }}" /></a></p>
		{% endif %}

		{% if question.source %}
			<p>Quelle: {{ question.source }}</p>
		{% endif %}

	</aside>

<!-- / #question-score -->
</div>
{% endblock %}